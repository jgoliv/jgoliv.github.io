---
title: "Survival analysis with `tidymodels`"
date: "2024-06-26"
date-modified: "2024-06-26"
bibliography: references.bib
nocite: |
  @*
---

```{r, include=FALSE}
library(dplyr)
library(echarts4r)
library(reactable)
library(reactablefmtr)
library(leaflet)
library(leaflet.extras)
library(modeldatatoo)
```

## Introducing survival analysis

Survival analysis is an important field in statistics and modeling that studies the expected duration until the occurrence of one or more specified events. Although it may seem like a regular time-to-event analysis, survival methods consider observations where the event of interest may not have occurred yet, i.e, it considers **censored** data.

The key concepts in survival analysis are:

-   **event:** The occurrence of the outcome of interest, such as death or relapse of a disease.

-   **time:** Interval from the start of an observation period until one of the following: occurrence of an event, end of the study, or loss of contact or withdrawal from the study.

-   **censoring:** Occurs when a subject does not experience the event during the observation period. This implies that a censored subject may or may not experience the event after the end of the observation period.

There are two main statistics that describe survival data: **survival probability** and **hazard probability**.

Survival probability denotes the likelihood that an subject will not experience the event of interest from a given time origin up to a future time $t$ (survive). On the other hand, hazard probability represents the likelihood that an individual under observation at time $t$ will experience the event at that moment.

Unlike survival probability, which emphasizes the absence of an event, the hazard probability focuses on the occurrence of the event. Essentially, the hazard describes the current rate of events, while survival reflects the cumulative non-occurrence over time.

For a more detailed approach to the basics of survival analysis, see [@clark_survival].

## The data

Survival data are time-to-event data with distinct start time and end time. In this article, we'll use the `building complaints` dataset of the `modeldatatoo` package. You can see more information about the data set [here](https://data.cityofnewyork.us/Housing-Development/DOB-Complaints-Received/eabe-havv/about_data).

This is the same dataset used in the survival case study [^1] and survival metrics[^2] tidymodels articles. It includes information about complaints received by the Department of Buildings in New York city, such as type of the complaint, the date that it was entered in their records, the date it was dispositioned, the location and the neighborhood of the building, and the status of the complaint.

[^1]: [How long until building complaints are dispositioned? A survival analysis case study](https://www.tidymodels.org/learn/statistics/survival-case-study/)

[^2]: [Dynamic Performance Metrics for Event Time Data](https://www.tidymodels.org/learn/statistics/survival-metrics/)

## Exploratory data analysis

First, we'll have a look on the data structure and in it's firsts rows:

```{r}
data <- modeldatatoo::building_complaints
```

```{r, echo=FALSE}
data |> glimpse()
```

```{r, echo=FALSE}
data |> head() |> reactable(compact = TRUE, theme = nytimes())
```

## Metrics

sahsahshas
